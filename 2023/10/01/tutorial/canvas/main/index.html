<!DOCTYPE html>
<html>
    <head><!-- hexo injector head_begin start --><script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>
<!-- hexo injector head_begin end -->
    <meta charset="utf-8">
    <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover" name="viewport" />
    <link rel="alternate icon" type="image/png" href="/img/favicon.png">
    <title>Hexo | </title>
    
<link rel="stylesheet" href="/css/reset.css">

    
<link rel="stylesheet" href="/css/style.css">

    
<link rel="stylesheet" href="/css/markdown.css">

    
<link rel="stylesheet" href="/css/fonts.css">

<meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">
</head>
    <body>
        <div class="paper">
            <div class="paper-main">
                
                    <div class="post-header">
    <a class="logo" href="/">Hexo</a>
    <a class="go-home" href="/">
        <svg width="8" height="14" viewBox="0 0 8 14">
            <path d="M7 1L1 7l6 6" stroke="#000" stroke-width="2" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
    </a>
</div>
                
                <div class="post-main">

    
    
        <div class="post-main-title">
            用盲文字符来在终端画黑白图像
        </div>
        <div class="post-meta">
            2023-10-01
        </div>
        <div class="post-md">
            <h1 id="用盲文字符来在终端画黑白图像"><a href="#用盲文字符来在终端画黑白图像" class="headerlink" title="用盲文字符来在终端画黑白图像"></a>用盲文字符来在终端画黑白图像</h1><h2 id="食用提示"><a href="#食用提示" class="headerlink" title="食用提示"></a>食用提示</h2><p>如果这篇文章在您的设备上显示很多方框，或许是字体出了问题。请确保自己使用的字体可以正常显示盲文。</p>
<p>在我的设备上，无论怎么操作都无法使 urxvt （rxvt ， xterm ） 表现出我想要的样子。因此在不建议您进行实验时使用 urxvt （rxvt ， xterm ） 。</p>
<h2 id="想法来源"><a href="#想法来源" class="headerlink" title="想法来源"></a>想法来源</h2><p>有一天发现盲文就是一堆像素点，就想着用盲文文字在终端画图。</p>
<h2 id="实现效果"><a href="#实现效果" class="headerlink" title="实现效果"></a>实现效果</h2><p><img src="https://cdn.luogu.com.cn/upload/image_hosting/lsp7f3e4.png" alt="show1.png"><br><img src="https://cdn.luogu.com.cn/upload/image_hosting/1oy9pwhi.png" alt="show2.png"></p>
<h2 id="分析"><a href="#分析" class="headerlink" title="分析"></a>分析</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">⠀⠁⠂⠃⠄⠅⠆⠇⠈⠉⠊⠋⠌⠍⠎⠏</span><br><span class="line">⠐⠑⠒⠓⠔⠕⠖⠗⠘⠙⠚⠛⠜⠝⠞⠟</span><br><span class="line">⠠⠡⠢⠣⠤⠥⠦⠧⠨⠩⠪⠫⠬⠭⠮⠯</span><br><span class="line">⠰⠱⠲⠳⠴⠵⠶⠷⠸⠹⠺⠻⠼⠽⠾⠿</span><br><span class="line">⡀⡁⡂⡃⡄⡅⡆⡇⡈⡉⡊⡋⡌⡍⡎⡏</span><br><span class="line">⡐⡑⡒⡓⡔⡕⡖⡗⡘⡙⡚⡛⡜⡝⡞⡟</span><br><span class="line">⡠⡡⡢⡣⡤⡥⡦⡧⡨⡩⡪⡫⡬⡭⡮⡯</span><br><span class="line">⡰⡱⡲⡳⡴⡵⡶⡷⡸⡹⡺⡻⡼⡽⡾⡿</span><br><span class="line">⢀⢁⢂⢃⢄⢅⢆⢇⢈⢉⢊⢋⢌⢍⢎⢏</span><br><span class="line">⢐⢑⢒⢓⢔⢕⢖⢗⢘⢙⢚⢛⢜⢝⢞⢟</span><br><span class="line">⢠⢡⢢⢣⢤⢥⢦⢧⢨⢩⢪⢫⢬⢭⢮⢯</span><br><span class="line">⢰⢱⢲⢳⢴⢵⢶⢷⢸⢹⢺⢻⢼⢽⢾⢿</span><br><span class="line">⣀⣁⣂⣃⣄⣅⣆⣇⣈⣉⣊⣋⣌⣍⣎⣏</span><br><span class="line">⣐⣑⣒⣓⣔⣕⣖⣗⣘⣙⣚⣛⣜⣝⣞⣟</span><br><span class="line">⣠⣡⣢⣣⣤⣥⣦⣧⣨⣩⣪⣫⣬⣭⣮⣯</span><br><span class="line">⣰⣱⣲⣳⣴⣵⣶⣷⣸⣹⣺⣻⣼⣽⣾⣿</span><br></pre></td></tr></table></figure>

<p>这是 UTF-8 中的盲文字符。共有 256 个。每个盲文字符都由数个点组成。点最多的盲文字符（右下角）有 8 个点，它看起来像个实心黑框框；点最少的盲文字符有 0 个点（左上角），虽然它看上去像个空格，但它真的和空格不是一个东西。</p>
<p>稍微观察可以发现，一个盲文字符可以当成 4x2 的小形位图使用，如果能够良好组织，使盲文字符按某种方式排列，就可以拼出大一些的位图。</p>
<p>不同的 4x2 位图共有 2^8 &#x3D; 256 个，而不同的盲文字符正好也有 256 个。这意味着盲文字符和 4x2 的位图之间有着一一对应的关系。为了方便盲文与位图的与相转化，我们需要设计一种编码方案。</p>
<p>上面列出的表显然是经过良好组织的，可以发现盲文字符的排布很有规律。找规律的过程略去不提，这里仅说编码方案。经过以下操作后，可以保证盲文字符和其对应的 4x2 位图有相同的编号：</p>
<p>盲文：将上表中的盲文从上到下，从左到右依次编号 0 到 255 。</p>
<p>位图：考虑搞一张权值表：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">1  8</span><br><span class="line">2  16</span><br><span class="line">4  32</span><br><span class="line">64 128</span><br></pre></td></tr></table></figure>

<p>将表中所有对应位图黑色位置的权值加起来，得到的和即为位图的编号。</p>
<p>例如，字符 “⢫” ，其编号为 171 ，其位图为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">1 1</span><br><span class="line">1 0</span><br><span class="line">0 1</span><br><span class="line">0 1</span><br></pre></td></tr></table></figure>

<p>和权值表 py 后得到 1 + 8 + 2 + 32 + 128 &#x3D; 171 ，和期待结果一致。</p>
<p>使用这个方法，可以将 4x2 的小位图和它所对应的盲文字符的编号对应起来。于是，我们就可以在终端画图了。</p>
<h2 id="实现"><a href="#实现" class="headerlink" title="实现"></a>实现</h2><p>首先对盲文字符打表：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">const</span> <span class="type">char</span> *magic_table[] = &#123;</span><br><span class="line">	<span class="string">&quot;⠀&quot;</span>, <span class="string">&quot;⠁&quot;</span>, <span class="string">&quot;⠂&quot;</span>, <span class="string">&quot;⠃&quot;</span>, <span class="string">&quot;⠄&quot;</span>, <span class="string">&quot;⠅&quot;</span>, <span class="string">&quot;⠆&quot;</span>, <span class="string">&quot;⠇&quot;</span>, <span class="string">&quot;⠈&quot;</span>, <span class="string">&quot;⠉&quot;</span>, <span class="string">&quot;⠊&quot;</span>, <span class="string">&quot;⠋&quot;</span>, <span class="string">&quot;⠌&quot;</span>, <span class="string">&quot;⠍&quot;</span>, <span class="string">&quot;⠎&quot;</span>, <span class="string">&quot;⠏&quot;</span>,</span><br><span class="line">	<span class="string">&quot;⠐&quot;</span>, <span class="string">&quot;⠑&quot;</span>, <span class="string">&quot;⠒&quot;</span>, <span class="string">&quot;⠓&quot;</span>, <span class="string">&quot;⠔&quot;</span>, <span class="string">&quot;⠕&quot;</span>, <span class="string">&quot;⠖&quot;</span>, <span class="string">&quot;⠗&quot;</span>, <span class="string">&quot;⠘&quot;</span>, <span class="string">&quot;⠙&quot;</span>, <span class="string">&quot;⠚&quot;</span>, <span class="string">&quot;⠛&quot;</span>, <span class="string">&quot;⠜&quot;</span>, <span class="string">&quot;⠝&quot;</span>, <span class="string">&quot;⠞&quot;</span>, <span class="string">&quot;⠟&quot;</span>,</span><br><span class="line">	<span class="string">&quot;⠠&quot;</span>, <span class="string">&quot;⠡&quot;</span>, <span class="string">&quot;⠢&quot;</span>, <span class="string">&quot;⠣&quot;</span>, <span class="string">&quot;⠤&quot;</span>, <span class="string">&quot;⠥&quot;</span>, <span class="string">&quot;⠦&quot;</span>, <span class="string">&quot;⠧&quot;</span>, <span class="string">&quot;⠨&quot;</span>, <span class="string">&quot;⠩&quot;</span>, <span class="string">&quot;⠪&quot;</span>, <span class="string">&quot;⠫&quot;</span>, <span class="string">&quot;⠬&quot;</span>, <span class="string">&quot;⠭&quot;</span>, <span class="string">&quot;⠮&quot;</span>, <span class="string">&quot;⠯&quot;</span>,</span><br><span class="line">	<span class="string">&quot;⠰&quot;</span>, <span class="string">&quot;⠱&quot;</span>, <span class="string">&quot;⠲&quot;</span>, <span class="string">&quot;⠳&quot;</span>, <span class="string">&quot;⠴&quot;</span>, <span class="string">&quot;⠵&quot;</span>, <span class="string">&quot;⠶&quot;</span>, <span class="string">&quot;⠷&quot;</span>, <span class="string">&quot;⠸&quot;</span>, <span class="string">&quot;⠹&quot;</span>, <span class="string">&quot;⠺&quot;</span>, <span class="string">&quot;⠻&quot;</span>, <span class="string">&quot;⠼&quot;</span>, <span class="string">&quot;⠽&quot;</span>, <span class="string">&quot;⠾&quot;</span>, <span class="string">&quot;⠿&quot;</span>,</span><br><span class="line"></span><br><span class="line">	<span class="string">&quot;⡀&quot;</span>, <span class="string">&quot;⡁&quot;</span>, <span class="string">&quot;⡂&quot;</span>, <span class="string">&quot;⡃&quot;</span>, <span class="string">&quot;⡄&quot;</span>, <span class="string">&quot;⡅&quot;</span>, <span class="string">&quot;⡆&quot;</span>, <span class="string">&quot;⡇&quot;</span>, <span class="string">&quot;⡈&quot;</span>, <span class="string">&quot;⡉&quot;</span>, <span class="string">&quot;⡊&quot;</span>, <span class="string">&quot;⡋&quot;</span>, <span class="string">&quot;⡌&quot;</span>, <span class="string">&quot;⡍&quot;</span>, <span class="string">&quot;⡎&quot;</span>, <span class="string">&quot;⡏&quot;</span>,</span><br><span class="line">	<span class="string">&quot;⡐&quot;</span>, <span class="string">&quot;⡑&quot;</span>, <span class="string">&quot;⡒&quot;</span>, <span class="string">&quot;⡓&quot;</span>, <span class="string">&quot;⡔&quot;</span>, <span class="string">&quot;⡕&quot;</span>, <span class="string">&quot;⡖&quot;</span>, <span class="string">&quot;⡗&quot;</span>, <span class="string">&quot;⡘&quot;</span>, <span class="string">&quot;⡙&quot;</span>, <span class="string">&quot;⡚&quot;</span>, <span class="string">&quot;⡛&quot;</span>, <span class="string">&quot;⡜&quot;</span>, <span class="string">&quot;⡝&quot;</span>, <span class="string">&quot;⡞&quot;</span>, <span class="string">&quot;⡟&quot;</span>,</span><br><span class="line">	<span class="string">&quot;⡠&quot;</span>, <span class="string">&quot;⡡&quot;</span>, <span class="string">&quot;⡢&quot;</span>, <span class="string">&quot;⡣&quot;</span>, <span class="string">&quot;⡤&quot;</span>, <span class="string">&quot;⡥&quot;</span>, <span class="string">&quot;⡦&quot;</span>, <span class="string">&quot;⡧&quot;</span>, <span class="string">&quot;⡨&quot;</span>, <span class="string">&quot;⡩&quot;</span>, <span class="string">&quot;⡪&quot;</span>, <span class="string">&quot;⡫&quot;</span>, <span class="string">&quot;⡬&quot;</span>, <span class="string">&quot;⡭&quot;</span>, <span class="string">&quot;⡮&quot;</span>, <span class="string">&quot;⡯&quot;</span>,</span><br><span class="line">	<span class="string">&quot;⡰&quot;</span>, <span class="string">&quot;⡱&quot;</span>, <span class="string">&quot;⡲&quot;</span>, <span class="string">&quot;⡳&quot;</span>, <span class="string">&quot;⡴&quot;</span>, <span class="string">&quot;⡵&quot;</span>, <span class="string">&quot;⡶&quot;</span>, <span class="string">&quot;⡷&quot;</span>, <span class="string">&quot;⡸&quot;</span>, <span class="string">&quot;⡹&quot;</span>, <span class="string">&quot;⡺&quot;</span>, <span class="string">&quot;⡻&quot;</span>, <span class="string">&quot;⡼&quot;</span>, <span class="string">&quot;⡽&quot;</span>, <span class="string">&quot;⡾&quot;</span>, <span class="string">&quot;⡿&quot;</span>,</span><br><span class="line"></span><br><span class="line">	<span class="string">&quot;⢀&quot;</span>, <span class="string">&quot;⢁&quot;</span>, <span class="string">&quot;⢂&quot;</span>, <span class="string">&quot;⢃&quot;</span>, <span class="string">&quot;⢄&quot;</span>, <span class="string">&quot;⢅&quot;</span>, <span class="string">&quot;⢆&quot;</span>, <span class="string">&quot;⢇&quot;</span>, <span class="string">&quot;⢈&quot;</span>, <span class="string">&quot;⢉&quot;</span>, <span class="string">&quot;⢊&quot;</span>, <span class="string">&quot;⢋&quot;</span>, <span class="string">&quot;⢌&quot;</span>, <span class="string">&quot;⢍&quot;</span>, <span class="string">&quot;⢎&quot;</span>, <span class="string">&quot;⢏&quot;</span>,</span><br><span class="line">	<span class="string">&quot;⢐&quot;</span>, <span class="string">&quot;⢑&quot;</span>, <span class="string">&quot;⢒&quot;</span>, <span class="string">&quot;⢓&quot;</span>, <span class="string">&quot;⢔&quot;</span>, <span class="string">&quot;⢕&quot;</span>, <span class="string">&quot;⢖&quot;</span>, <span class="string">&quot;⢗&quot;</span>, <span class="string">&quot;⢘&quot;</span>, <span class="string">&quot;⢙&quot;</span>, <span class="string">&quot;⢚&quot;</span>, <span class="string">&quot;⢛&quot;</span>, <span class="string">&quot;⢜&quot;</span>, <span class="string">&quot;⢝&quot;</span>, <span class="string">&quot;⢞&quot;</span>, <span class="string">&quot;⢟&quot;</span>,</span><br><span class="line">	<span class="string">&quot;⢠&quot;</span>, <span class="string">&quot;⢡&quot;</span>, <span class="string">&quot;⢢&quot;</span>, <span class="string">&quot;⢣&quot;</span>, <span class="string">&quot;⢤&quot;</span>, <span class="string">&quot;⢥&quot;</span>, <span class="string">&quot;⢦&quot;</span>, <span class="string">&quot;⢧&quot;</span>, <span class="string">&quot;⢨&quot;</span>, <span class="string">&quot;⢩&quot;</span>, <span class="string">&quot;⢪&quot;</span>, <span class="string">&quot;⢫&quot;</span>, <span class="string">&quot;⢬&quot;</span>, <span class="string">&quot;⢭&quot;</span>, <span class="string">&quot;⢮&quot;</span>, <span class="string">&quot;⢯&quot;</span>,</span><br><span class="line">	<span class="string">&quot;⢰&quot;</span>, <span class="string">&quot;⢱&quot;</span>, <span class="string">&quot;⢲&quot;</span>, <span class="string">&quot;⢳&quot;</span>, <span class="string">&quot;⢴&quot;</span>, <span class="string">&quot;⢵&quot;</span>, <span class="string">&quot;⢶&quot;</span>, <span class="string">&quot;⢷&quot;</span>, <span class="string">&quot;⢸&quot;</span>, <span class="string">&quot;⢹&quot;</span>, <span class="string">&quot;⢺&quot;</span>, <span class="string">&quot;⢻&quot;</span>, <span class="string">&quot;⢼&quot;</span>, <span class="string">&quot;⢽&quot;</span>, <span class="string">&quot;⢾&quot;</span>, <span class="string">&quot;⢿&quot;</span>,</span><br><span class="line"></span><br><span class="line">	<span class="string">&quot;⣀&quot;</span>, <span class="string">&quot;⣁&quot;</span>, <span class="string">&quot;⣂&quot;</span>, <span class="string">&quot;⣃&quot;</span>, <span class="string">&quot;⣄&quot;</span>, <span class="string">&quot;⣅&quot;</span>, <span class="string">&quot;⣆&quot;</span>, <span class="string">&quot;⣇&quot;</span>, <span class="string">&quot;⣈&quot;</span>, <span class="string">&quot;⣉&quot;</span>, <span class="string">&quot;⣊&quot;</span>, <span class="string">&quot;⣋&quot;</span>, <span class="string">&quot;⣌&quot;</span>, <span class="string">&quot;⣍&quot;</span>, <span class="string">&quot;⣎&quot;</span>, <span class="string">&quot;⣏&quot;</span>,</span><br><span class="line">	<span class="string">&quot;⣐&quot;</span>, <span class="string">&quot;⣑&quot;</span>, <span class="string">&quot;⣒&quot;</span>, <span class="string">&quot;⣓&quot;</span>, <span class="string">&quot;⣔&quot;</span>, <span class="string">&quot;⣕&quot;</span>, <span class="string">&quot;⣖&quot;</span>, <span class="string">&quot;⣗&quot;</span>, <span class="string">&quot;⣘&quot;</span>, <span class="string">&quot;⣙&quot;</span>, <span class="string">&quot;⣚&quot;</span>, <span class="string">&quot;⣛&quot;</span>, <span class="string">&quot;⣜&quot;</span>, <span class="string">&quot;⣝&quot;</span>, <span class="string">&quot;⣞&quot;</span>, <span class="string">&quot;⣟&quot;</span>,</span><br><span class="line">	<span class="string">&quot;⣠&quot;</span>, <span class="string">&quot;⣡&quot;</span>, <span class="string">&quot;⣢&quot;</span>, <span class="string">&quot;⣣&quot;</span>, <span class="string">&quot;⣤&quot;</span>, <span class="string">&quot;⣥&quot;</span>, <span class="string">&quot;⣦&quot;</span>, <span class="string">&quot;⣧&quot;</span>, <span class="string">&quot;⣨&quot;</span>, <span class="string">&quot;⣩&quot;</span>, <span class="string">&quot;⣪&quot;</span>, <span class="string">&quot;⣫&quot;</span>, <span class="string">&quot;⣬&quot;</span>, <span class="string">&quot;⣭&quot;</span>, <span class="string">&quot;⣮&quot;</span>, <span class="string">&quot;⣯&quot;</span>,</span><br><span class="line">	<span class="string">&quot;⣰&quot;</span>, <span class="string">&quot;⣱&quot;</span>, <span class="string">&quot;⣲&quot;</span>, <span class="string">&quot;⣳&quot;</span>, <span class="string">&quot;⣴&quot;</span>, <span class="string">&quot;⣵&quot;</span>, <span class="string">&quot;⣶&quot;</span>, <span class="string">&quot;⣷&quot;</span>, <span class="string">&quot;⣸&quot;</span>, <span class="string">&quot;⣹&quot;</span>, <span class="string">&quot;⣺&quot;</span>, <span class="string">&quot;⣻&quot;</span>, <span class="string">&quot;⣼&quot;</span>, <span class="string">&quot;⣽&quot;</span>, <span class="string">&quot;⣾&quot;</span>, <span class="string">&quot;⣿&quot;</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>接着实现 canvas 结构体。这里用 <code>unsigned char</code> 数组当成 <code>bool</code> 数组使用。日后优化时，可以用 bitmap 节省空间。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">canvas</span> &#123;</span></span><br><span class="line">	<span class="type">int</span> width;</span><br><span class="line">	<span class="type">int</span> height;</span><br><span class="line">	<span class="type">void</span> *buf;</span><br><span class="line">&#125; canvas;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">canvas_init</span><span class="params">(canvas *p, <span class="type">int</span> width, <span class="type">int</span> height)</span></span><br><span class="line">&#123;</span><br><span class="line">	width = ((width - <span class="number">1</span>) / <span class="number">2</span> + <span class="number">1</span>) * <span class="number">2</span>;</span><br><span class="line">	height = ((height - <span class="number">1</span>) / <span class="number">4</span> + <span class="number">1</span>) * <span class="number">4</span>;</span><br><span class="line">	p-&gt;width = width;</span><br><span class="line">	p-&gt;height = height;</span><br><span class="line">	p-&gt;buf = <span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(<span class="type">unsigned</span> <span class="type">char</span>) * width * height);</span><br><span class="line">	<span class="keyword">if</span> (p-&gt;buf == <span class="literal">NULL</span>)</span><br><span class="line">		<span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">canvas_clear</span><span class="params">(canvas p)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="built_in">free</span>(p.buf);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>实现画像素点和打印功能：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">canvas_draw</span><span class="params">(canvas p, <span class="type">int</span> x, <span class="type">int</span> y)</span></span><br><span class="line">&#123;</span><br><span class="line">	((<span class="type">unsigned</span> <span class="type">char</span> (*)[p.width])p.buf)[y][x] = <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">canvas_erase</span><span class="params">(canvas p, <span class="type">int</span> x, <span class="type">int</span> y)</span></span><br><span class="line">&#123;</span><br><span class="line">	((<span class="type">unsigned</span> <span class="type">char</span> (*)[p.width])p.buf)[y][x] = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">canvas_test</span><span class="params">(canvas p, <span class="type">int</span> x, <span class="type">int</span> y)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">return</span> ((<span class="type">unsigned</span> <span class="type">char</span> (*)[p.width])p.buf)[y][x];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">canvas_print</span><span class="params">(canvas p)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">int</span> i, j, k, l;</span><br><span class="line">	<span class="keyword">for</span> (i = p.height; i &gt; <span class="number">0</span>; i -= <span class="number">4</span>) &#123;</span><br><span class="line">		<span class="keyword">for</span> (j = <span class="number">0</span>; j &lt; p.width; j += <span class="number">2</span>) &#123;</span><br><span class="line">			<span class="type">int</span> id = <span class="number">0</span>;</span><br><span class="line">			<span class="keyword">for</span> (l = <span class="number">1</span>; l &gt;= <span class="number">0</span>; --l)</span><br><span class="line">				<span class="keyword">for</span> (k = <span class="number">3</span>; k &gt;= <span class="number">1</span>; --k)</span><br><span class="line">					id = (id &lt;&lt; <span class="number">1</span>) | canvas_test(p, j + l, i - k);</span><br><span class="line">			<span class="keyword">if</span> (canvas_test(p, j, i - <span class="number">4</span>))</span><br><span class="line">				id += <span class="number">64</span>;</span><br><span class="line">			<span class="keyword">if</span> (canvas_test(p, j + <span class="number">1</span>, i - <span class="number">4</span>))</span><br><span class="line">				id += <span class="number">128</span>;</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">&quot;%s&quot;</span>, magic_table[id]);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">putchar</span>(<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>实现完成。以下是函数功能与参数说明：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">int canvas_init(canvas *p, int width, int height); 将 p 初始化为宽 width 高 height 的画布</span><br><span class="line">void canvas_clear(canvas p); 销毁画布 p</span><br><span class="line">void canvas_draw(canvas p, int x, int y); 在 p 的 (x, y) 位置画上一个像素点</span><br><span class="line">void canvas_erase(canvas p, int x, int y); 擦除 p 中 (x, y) 位置上的像素点</span><br><span class="line">int canvas_test(canvas p, int x, int y); 返回 p 中 (x, y) 上是否已经画过</span><br><span class="line">void canvas_print(canvas p); 打印 p</span><br></pre></td></tr></table></figure>

<h2 id="实现示例中的效果"><a href="#实现示例中的效果" class="headerlink" title="实现示例中的效果"></a>实现示例中的效果</h2><p>用 ImageMagick 的 convert 命令将图片文件转为只有 2 种颜色的 xpm 文件，写个傻瓜 xpm 解析器，配合上面的代码简单处理即可得到示例中的效果。傻瓜解析器的代码见：<a target="_blank" rel="noopener" href="https://www.luogu.org/paste/npaqkp89">doxpm.c</a> 。</p>
<p>在本机上，实现示例效果的命令为：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ convert -colors 2 sample.png a.xpm</span><br><span class="line">$ gcc doxpm.c -o doxpm</span><br><span class="line">$ ./doxpm</span><br><span class="line">$ <span class="comment"># 如果需要彩色的话：</span></span><br><span class="line">$ ./doxpm | lolcat</span><br></pre></td></tr></table></figure>

<h2 id="完"><a href="#完" class="headerlink" title="完"></a>完</h2><p>代码仅被用来说明想法，并没有想写成一个可用的库。所以码风略快糙猛请多包涵。</p>
<p>感谢 zrz_orz 同学教我在洛谷日报上投稿，并提出大量修改意见。</p>

        </div>

    

</div>
                <div class="footer">
    <span>Copyright © 2022 Hexo</span>
    <span>Theme Designed By <a target="_blank" href="https://zheli.design/one-paper">這李設計</a></span>
</div>


<link rel="stylesheet" href="/css/a11y-dark.min.css">


<script src="/js/highlight.min.js"></script>


<script src="/js/highlightjs-line-numbers.js"></script>


<script>
    hljs.initHighlightingOnLoad();
    hljs.initLineNumbersOnLoad();
</script>

            </div>
        </div>
    </body>
</html>